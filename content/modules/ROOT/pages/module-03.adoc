= Cluster Interaction

The Cluster Interaction feature allows OpenShift Lightspeed to interact and gather information from your OpenShift cluster in a read-only manner. This enables the LLM to generate highly customized responses for your environment.

NOTE: This is currently a Technology Preview feature of OpenShift Lightspeed.

[#check-the-cluster-interaction-configuration]
== Check the Cluster Interaction Configuration

The OpenShift Lightspeed operator has been also configured to use the cluster interaction feature by default in this lab. Optionally, you can check how it is enabled in the _OLSConfig_ resource.

Again, navigate to *Ecosystem* and then *Installed Operators* in the left hand menu.

Now, click the *OpenShift Lightspeed Operator* and navigate to the *OLSConfig* tab. Then click on the `cluster` instance. Finally, select the *YAML* tab.

In the YAML editor, scroll down until you spot the `introspectionEnabled` flag under `.spec.ols.introspectionEnabled`. It should be set to `true`:

[source,yaml,role="execute",subs=attributes+]
----
...
spec:
...
  ols:
...
    introspectionEnabled: true
----

When this flag is enabled, OpenShift Lightspeed deploys an MCP server already preconfigured to communicate with the OpenShift API. This server provides some MCP tools, such as _events_list_, _namespaces_list_, _pods_list_in_namespace_, etc. When a user asks a question, the model may choose to call one of those tools to retrieve relevant information directly from the cluster to support the query. All tool usage is performed using the user's own credentials and access rights, preventing any privilege escalation.

[#gathering-information-from-the-cluster]
== Gathering Information from the Cluster

Now that we have seen that cluster interaction is available, you can try asking some questions about cluster resources and see how OpenShift Lightspeed responds. Open the chat interface, click the *Clear Chat (x)* button and ask:

[source,role="execute",subs=attributes+]
----
Show me the pods in the openshift-lightspeed namespace
----

The GPT-4 model likely chose to use the _pods_list_in_namespace_ tool to retrieve pod information from the _openshift-lightspeed_ namespace. You can view the tool's output by clicking the `pods_list_in_namespace` button displayed after the response. This information was used by the model to generate the final answer containing the list of all pods in that namespace.

Let's take cluster interaction one step further by combining it with follow-up questions. OpenShift Lightspeed can not only gather information from your cluster but also analyze it when you ask follow-up questions within the same chat session.

For example, let's ask OpenShift Lightspeed to retrieve and analyze the logs from the PostgreSQL server pod. In the same chat session, ask:

[source,role="execute",subs=attributes+]
----
Can you get and analyze the logs of the last pod?
----

OpenShift Lightspeed will use the _pods_log_ tool to retrieve the recent logs from the PostgreSQL database pod and then provide you with an analysis of what's happening in those logs. This demonstrates the power of combining cluster interaction with the conversational context maintained from your previous questions to navigate across different components and resources within the cluster.

== What if there's something wrong?

In the examples above, we saw that the pods were running healthy and their logs showed no issues. But what happens when you're actually facing a real problem that needs troubleshooting?

One of the most powerful features of OpenShift Lightspeed is the ability to attach resource information directly to your questions. By attaching YAML manifests, logs, or events from problematic resources, you provide OpenShift Lightspeed with the specific context it needs to diagnose issues effectively. Let's put this into practice in the next section by diagnosing and resolving a real issue in your cluster.